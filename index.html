<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>NodeMCU Control Page</title>
    <script type="text/javascript" src="http://lib.sinaapp.com/js/jquery/1.9.1/jquery-1.9.1.min.js"></script>
</head>
<body>
    <h1>Have a Try</h1>

    <ul>
        <li>
            按钮灯<input type="radio" value="buttonLight" name="light"  />
        </li>
        <li>    
            芯片灯<input type="radio" value="chipLight" name="light"/>
        </li>    
        <li>    
            关灯<input type="radio" value="clhoseLight" name="light"/>
        </li>
        <li>
            <input type="submit" value="操作" onclick="submit();" />
            <input type="hidden" value="" id="hidValue" /> 
        </li>
    </ul>

    <script>

        $(function () {
            var t = getQueryString("callback");
            if (t == null)
            {
                return;
            }

            if (t == "button")
                    $("input[name='light']:eq(0)").attr("checked", 'checked');
             else if(t== "chip")
                    $("input[name='light']:eq(1)").attr("checked", 'checked');
             else
                    $("input[name='light']:eq(2)").attr("checked", 'checked');
        });

        function submit()
        {
            var selected = $("input[name='light']:checked").val();

            console.debug(selected);

            if (selected == "undified")
            {
                alert('请选选择一个类型');
                return;
            }

            var url = "";

            if (selected == "buttonLight")
            {
                url = "buttonLight";
                
            }
            else if (selected == "chipLight") {
                url = "chipLight";
            }
            else {
                url = "closeall";
            }
            
            $("#hidValue").html(selected);
            $(window.location).attr('href', url);
        }

        function getQueryString(name) {
            var reg = new RegExp('(^|&)' + name + '=([^&]*)(&|$)', 'i');
            var r = window.location.search.substr(1).match(reg);
            if (r != null) {
                return unescape(r[2]);
            }
            return null;
        }

        
    </script>
</body>
</html>
